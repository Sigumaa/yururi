# AGENTS.md

## 基本

1. 本リポジトリの実装・設計・レビュー時の一次仕様は`docs/SPEC.md`とする。
2. 仕様の解釈に迷いがある場合は、まず`docs/SPEC.md`を参照し、差分が必要なら`docs/SPEC.md`を更新してから実装する。
3. 実装中に判断が必要になった場合、`docs/SPEC.md`に未記載の新方針は明示的に追記する。
4. 進行はPM方式を基本とし、メインエージェントは計画・分割・レビューを担当する。
5. 実装作業は基本的にメインエージェントが担当し、サブエージェントは調査・長時間待機・検証補助に限定して利用する。
6. 実装は一括で行わず、動作確認可能なフェーズ単位で区切る。
7. 各フェーズ完了後は、次フェーズへ進む前にユーザーのDiscord動作確認を待つ。

## 実装ルール

1. 変更は小さく分割し、フェーズ順は`docs/SPEC.md`の「実装フェーズ」に従う。
2. 新機能追加時は対応するテストを追加し、関連テストを実行する。
3. 会話ログ本文を永続化しない方針を守る。
4. 指定チャンネル外で動作しない制約を守る。

## ドキュメント運用

1. `docs/SPEC.md`は常に最新の決定内容を反映する。
2. 実装で方針変更した場合、コードより先に、または同時に`docs/SPEC.md`を更新する。
3. フェーズ完了時は、反映した仕様差分を`docs/SPEC.md`へ追記する。

## コミット運用

1. コミットはフェーズ単位で行う。
2. コミットメッセージはconventional commit準拠の英語一文とする。
